fileVersion: 1
id: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
name: STG_PIXELBO_REGULAR_INS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Isolate fills where insurance is regular priority
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4310447d-db03-4356-84e2-990c9cc104ac
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: NUMBER(38,0)
        description: To join to OrderItems later
        name: ORDERITEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41297ca3-c7b5-48b4-9722-6ce5b1608110
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383d1c36-bb6f-4502-98e0-ea8a03a346b7
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: INSURANCEPAYAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1f50eec-2cf9-4049-9c30-2326a790f9fe
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1222265a-2c50-4356-8985-e9706c37bcfc
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: PATIENTPAYAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0243427e-4c70-4045-9c06-8917bec124ea
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47805380-4854-4ac5-80a6-394e1ef94072
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: NUMBER(18,2)
        description: Don't trust for now. Will calculate later. Margins need to be updated 01/09/2026 MPB
        name: PATIENTPAYMARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dba8e7c-a445-4512-a533-42161bf47e04
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932ffe3f-d0d3-4814-9184-ddbd7a97d2e3
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: NUMBER(18,2)
        description: Don't trust for now. Will calculate later. Margins need to be updated 01/09/2026 MPB
        name: INSURANCEPAYMARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d01ec7e4-a322-4b70-aabb-a3e7cfa6a9e4
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f36f9167-78ec-437f-a0d9-8a428a93f090
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: VARCHAR(200)
        description: Name of insurance "plan"
        name: BaseInsuranceTemplateNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a4891dd-292b-40b3-a5e7-eb11426c0237
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cbacaad-ef88-49af-bb04-d549ac2e40c0
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: VARCHAR(256)
        description: Name of insurance "company" or rollup
        name: COMPANYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60c825b1-3adc-49b5-91bf-dcd922cb972b
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d5f9885-07ce-4407-a44a-475157e23a71
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: NUMBER(38,0)
        description: Priority of the plan on the patient profile
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97edec9e-5bd2-4012-a617-3ef6315c74e3
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96caf9a2-228b-4218-951f-0f1e4f2a0ac8
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: BOOLEAN
        description: ""
        name: OrderRefillInsurances_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e742ea7-b56c-4f55-8424-e5eb621155d2
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33a135a8-5c22-4a34-bda4-f1e9c31fe718
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: OrderRefillInsurances_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f0f37c8-2426-4db7-992a-dfe0d03a0c2f
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37778c7f-da8d-4405-9d27-7baf8a2d1368
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: BOOLEAN
        description: ""
        name: Insurance_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23fba747-6b0e-4b92-99e2-53bdd70ed0c6
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 930cb77d-eb0a-4076-b76d-3d286e4e3ba7
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: Insurance_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddf30073-5b04-4fd9-bb8a-99623e62f237
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad8c8642-7315-494f-a12d-70df54886629
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: BOOLEAN
        description: ""
        name: InsuranceCompany_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fd09f34-114a-420a-a17a-257b86d002b3
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6752df82-97e7-4e65-9c0d-f333e7563f71
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: InsuranceCompany_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1edf373f-6fec-4f8a-9052-d80d6f8f3596
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d45b406-1f7e-42ab-bd12-2137dd298f50
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: BOOLEAN
        description: ""
        name: BaseInsuranceTemplate_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6504322a-547d-4b61-99f3-a96052778007
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0bf6dbe-7f1f-4e60-b19d-c4ab61f44fc3
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: BaseInsuranceTemplate_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33608d2-8630-4148-bbbf-50075fa7938d
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fde8c6a8-5bea-45dc-829e-1664f608d825
          stepCounter: ce1c8c69-bbf1-4473-993b-4a77ec7f830a
        config: {}
        dataType: Number (10)
        defaultValue: ""
        description: This ranks the position since you can have multiple regular plans on a profile (Primary and Secondary only allow one).
        keyColumnType: None
        name: RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41297ca3-c7b5-48b4-9722-6ce5b1608110
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: DENSE_RANK() OVER (PARTITION BY "STG_PIXELBO_ALL_INSURANCES"."ORDERITEMID" ORDER BY  "STG_PIXELBO_ALL_INSURANCES"."OrderRefillInsurancesID" ASC)
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_PIXELBO_ALL_INSURANCES: 753815ba-4452-44e2-869c-4662c9134521
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STG_PIXELBO_ALL_INSURANCES
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'STG_PIXELBO_ALL_INSURANCES') }} "STG_PIXELBO_ALL_INSURANCES"

            where "STG_PIXELBO_ALL_INSURANCES"."PRIORITY"=3
        name: STG_PIXELBO_REGULAR_INS
        noLinkRefs: []
  name: STG_PIXELBO_REGULAR_INS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
