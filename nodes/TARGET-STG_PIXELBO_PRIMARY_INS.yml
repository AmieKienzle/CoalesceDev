fileVersion: 1
id: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
name: STG_PIXELBO_PRIMARY_INS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Isolate fills where insurance is primary priority
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d646008-7617-4002-a4ce-93746311410d
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: NUMBER(38,0)
        description: To join to OrderItems later
        name: ORDERITEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41297ca3-c7b5-48b4-9722-6ce5b1608110
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 098b66db-b480-4937-8a3e-1ed002e514ea
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: INSURANCEPAYAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1f50eec-2cf9-4049-9c30-2326a790f9fe
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 162e0356-d3d4-45d1-b13e-f8bb86322091
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: PATIENTPAYAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0243427e-4c70-4045-9c06-8917bec124ea
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57de8bec-9d2e-434c-8436-6fd83e7711bd
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: NUMBER(18,2)
        description: Don't trust for now. Will calculate later. Margins need to be updated 01/09/2026 MPB
        name: PATIENTPAYMARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dba8e7c-a445-4512-a533-42161bf47e04
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19d337d3-55b6-4032-941c-3ab52163f9ae
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: NUMBER(18,2)
        description: Don't trust for now. Will calculate later. Margins need to be updated 01/09/2026 MPB
        name: INSURANCEPAYMARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d01ec7e4-a322-4b70-aabb-a3e7cfa6a9e4
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d3c5134-0169-4c99-b13c-1d472ae2c513
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: VARCHAR(200)
        description: Name of insurance "plan"
        name: BaseInsuranceTemplateNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a4891dd-292b-40b3-a5e7-eb11426c0237
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad500a31-4042-41bc-8fa4-bc66644c1a12
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: VARCHAR(256)
        description: Name of insurance "company" or rollup
        name: COMPANYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60c825b1-3adc-49b5-91bf-dcd922cb972b
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb299369-fea4-4435-bb4a-544019b97b8f
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: NUMBER(38,0)
        description: Priority of the plan on the patient profile
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97edec9e-5bd2-4012-a617-3ef6315c74e3
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d507c713-a614-4b97-803c-95a744335500
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: BOOLEAN
        description: ""
        name: OrderRefillInsurances_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e742ea7-b56c-4f55-8424-e5eb621155d2
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a237a9-0874-485c-acef-c379ac6b78db
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: OrderRefillInsurances_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f0f37c8-2426-4db7-992a-dfe0d03a0c2f
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14290740-6cfb-48af-81d6-269965f9289e
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: BOOLEAN
        description: ""
        name: Insurance_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23fba747-6b0e-4b92-99e2-53bdd70ed0c6
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86ec7d6c-58ca-4316-a427-0925a61c6813
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: Insurance_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddf30073-5b04-4fd9-bb8a-99623e62f237
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0b69d98-fa72-4935-8a62-8c3ed7ffb0b6
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: BOOLEAN
        description: ""
        name: InsuranceCompany_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fd09f34-114a-420a-a17a-257b86d002b3
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfc66e6e-5501-4bbb-af66-6b7d473d5ede
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: InsuranceCompany_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1edf373f-6fec-4f8a-9052-d80d6f8f3596
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11cc2b93-d633-4841-8265-5345ab3176ea
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: BOOLEAN
        description: ""
        name: BaseInsuranceTemplate_FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6504322a-547d-4b61-99f3-a96052778007
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f077387-e412-4c31-ad6e-08333c3daa2f
          stepCounter: 057021aa-01a0-4a3b-9447-83e13c0ae4e1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: BaseInsuranceTemplate_FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33608d2-8630-4148-bbbf-50075fa7938d
                stepCounter: 753815ba-4452-44e2-869c-4662c9134521
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_PIXELBO_ALL_INSURANCES: 753815ba-4452-44e2-869c-4662c9134521
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STG_PIXELBO_ALL_INSURANCES
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'STG_PIXELBO_ALL_INSURANCES') }} "STG_PIXELBO_ALL_INSURANCES"

            where "STG_PIXELBO_ALL_INSURANCES"."PRIORITY"=0
        name: STG_PIXELBO_PRIMARY_INS
        noLinkRefs: []
  name: STG_PIXELBO_PRIMARY_INS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
