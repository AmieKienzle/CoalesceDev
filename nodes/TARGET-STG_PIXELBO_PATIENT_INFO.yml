fileVersion: 1
id: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
name: STG_PIXELBO_PATIENT_INFO
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71ed0109-be4d-45ac-ac27-6b78ccb418fd
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PatientID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4b08dd-f681-4001-8252-8cee0fc1624a
                stepCounter: 3e2b1d00-836d-4e6f-aeb8-6b7c2e46abe4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5882969-d1ae-48e3-a9c3-207c81d0c936
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: NUMBER(38,0)
        description: Join
        name: PATIENTTYPEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 353bc8db-6fda-41b2-acf2-9b8562655130
                stepCounter: 3e2b1d00-836d-4e6f-aeb8-6b7c2e46abe4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa32503a-a260-4ffa-a82c-eeb282b78b3e
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: DATE
        description: Select
        name: DATEOFBIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 131490cc-3572-43db-9bfd-640895d46dd3
                stepCounter: 3e2b1d00-836d-4e6f-aeb8-6b7c2e46abe4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb9df5f6-a7e4-477a-8dd2-6ca5012ac94f
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: VARCHAR(256)
        description: Select for PatientTypeName
        name: TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 164a5971-3236-445b-9c51-70991f23ea0e
                stepCounter: 6eb0c259-f2c4-4794-a20c-83148b4ac789
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dad3acd7-cf8a-4966-9129-c7ca61c2b944
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: VARCHAR(128)
        description: ""
        name: SURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f30040-560b-411f-853e-e101ac1ae45e
                stepCounter: 565a8db0-4d7b-438b-9d97-d19de4b04aa9
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5f2458e1-9c03-4e21-9ecc-192b00a0c047
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc8dbbd-3cae-461a-a119-cbdc5be35fa5
                stepCounter: 565a8db0-4d7b-438b-9d97-d19de4b04aa9
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 08fde926-3f3a-4cc9-aa39-93314578963f
          stepCounter: 8f527a14-6e6a-43e5-9cec-be460ce49a0c
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: PatientName
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc8dbbd-3cae-461a-a119-cbdc5be35fa5
                stepCounter: 565a8db0-4d7b-438b-9d97-d19de4b04aa9
            transform: CONCAT("STG_PIXELBO_ABPUSERS"."NAME", ' ', "STG_PIXELBO_ABPUSERS"."SURNAME")
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_PIXELBO_ABPUSERS: 565a8db0-4d7b-438b-9d97-d19de4b04aa9
          STG_PIXELBO_PATIENTS: 3e2b1d00-836d-4e6f-aeb8-6b7c2e46abe4
          STG_PIXELBO_PATIENTTYPES: 6eb0c259-f2c4-4794-a20c-83148b4ac789
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STG_PIXELBO_ABPUSERS
          - locationName: TARGET
            nodeName: STG_PIXELBO_PATIENTS
          - locationName: TARGET
            nodeName: STG_PIXELBO_PATIENTTYPES
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'STG_PIXELBO_PATIENTS') }} "STG_PIXELBO_PATIENTS"

            LEFT JOIN {{ ref('TARGET', 'STG_PIXELBO_PATIENTTYPES') }} "STG_PIXELBO_PATIENTTYPES"
            ON "STG_PIXELBO_PATIENTS"."PATIENTTYPEID" = "STG_PIXELBO_PATIENTTYPES"."ID"

            JOIN {{ ref('TARGET', 'STG_PIXELBO_ABPUSERS') }} "STG_PIXELBO_ABPUSERS"
            ON "STG_PIXELBO_PATIENTS"."ID" = "STG_PIXELBO_ABPUSERS"."ID"

            WHERE "STG_PIXELBO_PATIENTS"."MERGETARGETID" IS NULL
        name: STG_PIXELBO_PATIENT_INFO
        noLinkRefs: []
  name: STG_PIXELBO_PATIENT_INFO
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
